---
layout: post
title: 5.PHP多进程编程
category: 技术
tags: PHP
keywords: 
description: 
---
PHP的进程控制支持实现了Unix方式的进程创建, 程序执行, 信号处理以及进程的中断。 进程控制不能被应用在Web服务器环境，当其被用于Web服务环境时可能会带来意外的结果。

###准备
```

#确认安装pcntl和posix
php -m
```

###创建子进程
pcntl_fork()在当前进程当前位置产生子进程。父进程和子进程的唯一区别是PID和PPID不同。

```

#pcntl_fork()调用失败返回-1;调用成功，父进程中返回子进程PID,子进程中返回0；
#子进程和父进程的代码是一样的，所以要通过if语句分配任务。
$pid = pcntl_fork();
#所以如果调用成功， 将输出两行信息。
echo $pid.PHP_EOL;
```

###子进程回收
当子进程比父进程先结束，而父进程未对其做任何处理，子进程就变成了僵尸进程。　可以在父进程结束之前调用pcntl_wait()函数，将父进程挂起，直到有一个子进程退出为止。如果有一个子进程变成了僵尸进程，将会立即返回。

###信号
```

#安装一个信号处理器(定义信号和处理他的方法)
pcntl_signal();
#信号分发，调用等待信号的处理器(调用处理信号的方法)
pcntl_signal_dispatch();
```
